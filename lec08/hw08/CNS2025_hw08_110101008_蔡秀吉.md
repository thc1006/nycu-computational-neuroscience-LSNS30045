## FHN as a Python class
![image](https://hackmd.io/_uploads/Sye692RRlg.png)

> * **v**：快變的「活化」變數（像膜電位），
> * **w**：慢變的「恢復/抑制」變數。

**圖 1**：在 (I=0.7) 時段，解軌跡離開靜息點，沿著 v-nullcline 的左右支快跑（快變），穿插著朝 w-nullcline 緩慢靠攏（慢變）。切回 (I=0.3) 後極限環仍保留但頻率降低；回 (I=0) 後因跨不過閾值，振盪消失，回到平衡。這是標準的 FHN 行為。

![image](https://hackmd.io/_uploads/HkMAq3C0ge.png)

**圖 2**：刺激的三段式階梯清楚標定了三段動力學（強振盪 → 弱振盪 → 靜息魔電位）。


## FHN in Brian2 (unit‑safe, same dynamics)

![image](https://hackmd.io/_uploads/rkaCRh0Clx.png)

**圖 3**：Brian2 版 FHN 的 $v(t)/w(t)$：用 `NeuronGroup` 寫同一組方程，狀態無單位 $: 1$，右側用 $/ms$ 確保導數有 $(1/\mathrm{s})$ 單位；最終結果與 **圖一** 看起來幾呼重疊，證明兩種實作等價。


![image](https://hackmd.io/_uploads/r1BJ1600lg.png)

**圖 4**：用 $TimedArray(I_arr, dt)$ 餵同一份階梯輸入，與 **圖二** 在切換時刻一致。
